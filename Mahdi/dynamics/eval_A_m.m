function A_m = eval_A_m(q_m)


q1_m = q_m(1);
q2_m = q_m(2);
q3_m = q_m(3);

[m1, m2, m3, l1, l2, l3, g] = set_parameters();
m=m1;

t2 = l1.^2;
t3 = q1_m-q2_m;
t4 = cos(t3);
t5 = q1_m-q3_m;
t6 = cos(t5);
A_m = reshape([m.*t2.*(-5.0./4.0)-m3.*t2+(l1.*l2.*m.*t4)./2.0-(l1.*l3.*m3.*t6)./2.0,m.*t2.*(-1.0./4.0),0.0,l2.*m.*(l2-l1.*t4.*2.0).*(-1.0./4.0),0.0,0.0,l3.*m3.*(l3+l1.*t6.*2.0).*(-1.0./4.0),0.0,l3.^2.*m3.*(-1.0./4.0)],[3,3]);

end