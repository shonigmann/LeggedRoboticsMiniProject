function A_m = eval_A_m(q_m)


q1_m = q_m(1);
q2_m = q_m(2);
q3_m = q_m(3);

[m1, m2, m3, l1, l2, l3, g] = set_parameters();
m=m1;


t2 = q1_m.*2.0;
t3 = cos(t2);
t4 = q1_m+q2_m;
t5 = cos(t4);
t6 = cos(q2_m);
t7 = cos(q1_m);
t8 = cos(q3_m);
t9 = sin(q3_m);
A_m = reshape([l1.*(l1.*m.*5.0+l1.*m3.*4.0-l2.*m.*cos(q1_m-q2_m).*2.0+l3.*m3.*cos(q1_m-q3_m).*2.0+l1.*m.*t3.*6.0+l1.*m3.*t3.*4.0-l2.*m.*t5.*6.0-l2.*m3.*t5.*4.0).*(-1.0./4.0),l1.^2.*m.*(-1.0./4.0),0.0,(l2.*m.*(l2-l2.*t6.^2.*4.0+l1.*t6.*t7.*4.0))./4.0,0.0,0.0,l3.*m3.*t8.*(l1.*t7.*2.0-l2.*t6+(l3.*t8)./2.0).*(-1.0./2.0)-(l3.*m3.*t9.*((l3.*t9)./2.0+l2.*sin(q2_m)))./2.0,0.0,l3.^2.*m3.*(-1.0./4.0)],[3,3]);

end